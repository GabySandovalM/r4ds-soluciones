<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Datos relacionales | R para Ciencia de Datos: Soluciones de los ejercicios</title>
  <meta name="description" content="Propuestas de soluciones para los ejercicios del libro R para Ciencia de Datos" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Datos relacionales | R para Ciencia de Datos: Soluciones de los ejercicios" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://es.r4ds.hadley.nz/" />
  <meta property="og:image" content="http://es.r4ds.hadley.nz/cover.png" />
  <meta property="og:description" content="Propuestas de soluciones para los ejercicios del libro R para Ciencia de Datos" />
  <meta name="github-repo" content="cienciadedatos/r4ds" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Datos relacionales | R para Ciencia de Datos: Soluciones de los ejercicios" />
  
  <meta name="twitter:description" content="Propuestas de soluciones para los ejercicios del libro R para Ciencia de Datos" />
  <meta name="twitter:image" content="http://es.r4ds.hadley.nz/cover.png" />

<meta name="author" content="Riva Quiroga" />
<meta name="author" content="Mauricio ‘Pachá’ Vargas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="datos-ordenados.html">
<link rel="next" href="cadenas-de-caracteres.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="r4ds.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Soluciones R para Ciencia de Datos</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenida</a></li>
<li class="chapter" data-level="1" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html"><i class="fa fa-check"></i><b>2</b> Visualización de datos</a><ul>
<li class="chapter" data-level="2.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#paquetes-necesarios"><i class="fa fa-check"></i><b>2.1</b> Paquetes necesarios</a></li>
<li class="chapter" data-level="2.2" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#primeros-pasos"><i class="fa fa-check"></i><b>2.2</b> Primeros pasos</a><ul>
<li class="chapter" data-level="2.2.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios"><i class="fa fa-check"></i><b>2.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#mapeos-esteticos"><i class="fa fa-check"></i><b>2.3</b> Mapeos estéticos</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios-1"><i class="fa fa-check"></i><b>2.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#separar-en-facetas"><i class="fa fa-check"></i><b>2.4</b> Separar en facetas</a><ul>
<li class="chapter" data-level="2.4.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios-2"><i class="fa fa-check"></i><b>2.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#objetos-geometricos"><i class="fa fa-check"></i><b>2.5</b> Objetos geométricos</a><ul>
<li class="chapter" data-level="2.5.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios-3"><i class="fa fa-check"></i><b>2.5.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#transformaciones-estadisticas"><i class="fa fa-check"></i><b>2.6</b> Transformaciones estadísticas</a><ul>
<li class="chapter" data-level="2.6.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios-4"><i class="fa fa-check"></i><b>2.6.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ajustes-de-posicion"><i class="fa fa-check"></i><b>2.7</b> Ajustes de posición</a><ul>
<li class="chapter" data-level="2.7.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios-5"><i class="fa fa-check"></i><b>2.7.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#sistemas-de-coordenadas"><i class="fa fa-check"></i><b>2.8</b> Sistemas de coordenadas</a><ul>
<li class="chapter" data-level="2.8.1" data-path="visualizacion-de-datos.html"><a href="visualizacion-de-datos.html#ejercicios-6"><i class="fa fa-check"></i><b>2.8.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="flujo-de-trabajo-conocimientos-basicos.html"><a href="flujo-de-trabajo-conocimientos-basicos.html"><i class="fa fa-check"></i><b>3</b> Flujo de trabajo: conocimientos básicos</a><ul>
<li class="chapter" data-level="3.1" data-path="flujo-de-trabajo-conocimientos-basicos.html"><a href="flujo-de-trabajo-conocimientos-basicos.html#practica"><i class="fa fa-check"></i><b>3.1</b> Práctica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>4</b> Transformación de datos</a><ul>
<li class="chapter" data-level="4.1" data-path="transform.html"><a href="transform.html#introduccion-1"><i class="fa fa-check"></i><b>4.1</b> Introducción</a><ul>
<li class="chapter" data-level="4.1.1" data-path="transform.html"><a href="transform.html#ejercicios-7"><i class="fa fa-check"></i><b>4.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="transform.html"><a href="transform.html#reordenar-las-filas-con-arrange"><i class="fa fa-check"></i><b>4.2</b> Reordenar las filas con <code>arrange()</code></a><ul>
<li class="chapter" data-level="4.2.1" data-path="transform.html"><a href="transform.html#ejercicios-8"><i class="fa fa-check"></i><b>4.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="transform.html"><a href="transform.html#select"><i class="fa fa-check"></i><b>4.3</b> Seleccionar columnas con <code>select()</code></a><ul>
<li class="chapter" data-level="4.3.1" data-path="transform.html"><a href="transform.html#ejercicios-9"><i class="fa fa-check"></i><b>4.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="transform.html"><a href="transform.html#anadir-nuevas-variables-con-mutate"><i class="fa fa-check"></i><b>4.4</b> Añadir nuevas variables con <code>mutate()</code></a><ul>
<li class="chapter" data-level="4.4.1" data-path="transform.html"><a href="transform.html#ejercicios-10"><i class="fa fa-check"></i><b>4.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="transform.html"><a href="transform.html#resumenes-agrupados-con-summarise"><i class="fa fa-check"></i><b>4.5</b> Resúmenes agrupados con <code>summarise()</code></a><ul>
<li class="chapter" data-level="4.5.1" data-path="transform.html"><a href="transform.html#ejercicios-11"><i class="fa fa-check"></i><b>4.5.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="transform.html"><a href="transform.html#transformaciones-agrupadas-y-filtros"><i class="fa fa-check"></i><b>4.6</b> Transformaciones agrupadas (y filtros)</a><ul>
<li class="chapter" data-level="4.6.1" data-path="transform.html"><a href="transform.html#ejercicios-12"><i class="fa fa-check"></i><b>4.6.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="flujo-de-trabajo-scripts.html"><a href="flujo-de-trabajo-scripts.html"><i class="fa fa-check"></i><b>5</b> Flujo de trabajo: <em>Scripts</em></a><ul>
<li class="chapter" data-level="5.1" data-path="flujo-de-trabajo-scripts.html"><a href="flujo-de-trabajo-scripts.html#practica-1"><i class="fa fa-check"></i><b>5.1</b> Práctica</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>6</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="7" data-path="workflow-projects.html"><a href="workflow-projects.html"><i class="fa fa-check"></i><b>7</b> Workflow: projects</a></li>
<li class="chapter" data-level="8" data-path="tibbles.html"><a href="tibbles.html"><i class="fa fa-check"></i><b>8</b> Tibbles</a><ul>
<li class="chapter" data-level="8.1" data-path="tibbles.html"><a href="tibbles.html#ejercicios-13"><i class="fa fa-check"></i><b>8.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html"><i class="fa fa-check"></i><b>9</b> Importación de datos</a><ul>
<li class="chapter" data-level="9.1" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html#introduccion-2"><i class="fa fa-check"></i><b>9.1</b> Introducción</a><ul>
<li class="chapter" data-level="9.1.1" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html#prerrequisitos"><i class="fa fa-check"></i><b>9.1.1</b> Prerrequisitos</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html#comenzando"><i class="fa fa-check"></i><b>9.2</b> Comenzando</a><ul>
<li class="chapter" data-level="9.2.1" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html#ejercicios-14"><i class="fa fa-check"></i><b>9.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html#analizando-un-vector"><i class="fa fa-check"></i><b>9.3</b> Analizando un vector</a><ul>
<li class="chapter" data-level="9.3.1" data-path="importacion-de-datos.html"><a href="importacion-de-datos.html#ejercicios-15"><i class="fa fa-check"></i><b>9.3.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="datos-ordenados.html"><a href="datos-ordenados.html"><i class="fa fa-check"></i><b>10</b> Datos ordenados</a><ul>
<li class="chapter" data-level="10.1" data-path="datos-ordenados.html"><a href="datos-ordenados.html#datos-ordenados-1"><i class="fa fa-check"></i><b>10.1</b> Datos ordenados</a><ul>
<li class="chapter" data-level="10.1.1" data-path="datos-ordenados.html"><a href="datos-ordenados.html#ejercicios-16"><i class="fa fa-check"></i><b>10.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="datos-ordenados.html"><a href="datos-ordenados.html#reunir-y-esparcir"><i class="fa fa-check"></i><b>10.2</b> Reunir y Esparcir</a><ul>
<li class="chapter" data-level="10.2.1" data-path="datos-ordenados.html"><a href="datos-ordenados.html#ejercicios-17"><i class="fa fa-check"></i><b>10.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="datos-ordenados.html"><a href="datos-ordenados.html#separar-y-unir"><i class="fa fa-check"></i><b>10.3</b> Separar y unir</a><ul>
<li class="chapter" data-level="10.3.1" data-path="datos-ordenados.html"><a href="datos-ordenados.html#ejercicios-18"><i class="fa fa-check"></i><b>10.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="datos-ordenados.html"><a href="datos-ordenados.html#valores-faltantes"><i class="fa fa-check"></i><b>10.4</b> Valores faltantes</a><ul>
<li class="chapter" data-level="10.4.1" data-path="datos-ordenados.html"><a href="datos-ordenados.html#ejercicios-19"><i class="fa fa-check"></i><b>10.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="datos-ordenados.html"><a href="datos-ordenados.html#estudio-de-caso"><i class="fa fa-check"></i><b>10.5</b> Estudio de caso</a><ul>
<li class="chapter" data-level="10.5.1" data-path="datos-ordenados.html"><a href="datos-ordenados.html#ejercicios-20"><i class="fa fa-check"></i><b>10.5.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="datos-ordenados.html"><a href="datos-ordenados.html#datos-no-ordenados"><i class="fa fa-check"></i><b>10.6</b> Datos no ordenados</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="datos-relacionales.html"><a href="datos-relacionales.html"><i class="fa fa-check"></i><b>11</b> Datos relacionales</a><ul>
<li class="chapter" data-level="11.1" data-path="datos-relacionales.html"><a href="datos-relacionales.html#paquetes-necesarios-1"><i class="fa fa-check"></i><b>11.1</b> Paquetes necesarios</a></li>
<li class="chapter" data-level="11.2" data-path="datos-relacionales.html"><a href="datos-relacionales.html#nycflights13-relational"><i class="fa fa-check"></i><b>11.2</b> datos</a><ul>
<li class="chapter" data-level="11.2.1" data-path="datos-relacionales.html"><a href="datos-relacionales.html#ejercicios-21"><i class="fa fa-check"></i><b>11.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="datos-relacionales.html"><a href="datos-relacionales.html#llaves"><i class="fa fa-check"></i><b>11.3</b> Llaves</a><ul>
<li class="chapter" data-level="11.3.1" data-path="datos-relacionales.html"><a href="datos-relacionales.html#ejercicios-22"><i class="fa fa-check"></i><b>11.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="datos-relacionales.html"><a href="datos-relacionales.html#mutating-joins"><i class="fa fa-check"></i><b>11.4</b> Uniones de transformación</a><ul>
<li class="chapter" data-level="11.4.1" data-path="datos-relacionales.html"><a href="datos-relacionales.html#ejercicios-23"><i class="fa fa-check"></i><b>11.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="datos-relacionales.html"><a href="datos-relacionales.html#filtering-joins"><i class="fa fa-check"></i><b>11.5</b> Uniones de filtro</a><ul>
<li class="chapter" data-level="11.5.1" data-path="datos-relacionales.html"><a href="datos-relacionales.html#ejercicios-24"><i class="fa fa-check"></i><b>11.5.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="datos-relacionales.html"><a href="datos-relacionales.html#problemas-de-las-uniones"><i class="fa fa-check"></i><b>11.6</b> Problemas de las uniones</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html"><i class="fa fa-check"></i><b>12</b> Cadenas de caracteres</a><ul>
<li class="chapter" data-level="12.1" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#cadenas-elementos-basicos"><i class="fa fa-check"></i><b>12.1</b> Cadenas: elementos básicos</a><ul>
<li class="chapter" data-level="12.1.1" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#ejercicios-25"><i class="fa fa-check"></i><b>12.1.1</b> Ejercicios</a></li>
<li class="chapter" data-level="12.1.2" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#buscar-coincidencia-de-patrones-con-expresiones-regulares"><i class="fa fa-check"></i><b>12.1.2</b> Buscar coincidencia de patrones con expresiones regulares</a></li>
<li class="chapter" data-level="12.1.3" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#anclas"><i class="fa fa-check"></i><b>12.1.3</b> Anclas</a></li>
<li class="chapter" data-level="12.1.4" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#clases-de-caracteres-y-alternativas"><i class="fa fa-check"></i><b>12.1.4</b> Clases de caracteres y alternativas</a></li>
<li class="chapter" data-level="12.1.5" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#repeticion"><i class="fa fa-check"></i><b>12.1.5</b> Repetición</a></li>
<li class="chapter" data-level="12.1.6" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#agrupamiento-y-referencias-previas"><i class="fa fa-check"></i><b>12.1.6</b> Agrupamiento y referencias previas</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#herramientas"><i class="fa fa-check"></i><b>12.2</b> Herramientas</a><ul>
<li class="chapter" data-level="12.2.1" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#ejercicios-31"><i class="fa fa-check"></i><b>12.2.1</b> Ejercicios</a></li>
<li class="chapter" data-level="12.2.2" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#extraer-coincidencias"><i class="fa fa-check"></i><b>12.2.2</b> Extraer coincidencias</a></li>
<li class="chapter" data-level="12.2.3" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#coincidencias-agrupadas"><i class="fa fa-check"></i><b>12.2.3</b> Coincidencias agrupadas</a></li>
<li class="chapter" data-level="12.2.4" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#remplazar-coincidencias"><i class="fa fa-check"></i><b>12.2.4</b> Remplazar coincidencias</a></li>
<li class="chapter" data-level="12.2.5" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#divisiones"><i class="fa fa-check"></i><b>12.2.5</b> Divisiones</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#otro-tipo-de-patrones"><i class="fa fa-check"></i><b>12.3</b> Otro tipo de patrones</a><ul>
<li class="chapter" data-level="12.3.1" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#ejercicios-36"><i class="fa fa-check"></i><b>12.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#stringi"><i class="fa fa-check"></i><b>12.4</b> stringi</a><ul>
<li class="chapter" data-level="12.4.1" data-path="cadenas-de-caracteres.html"><a href="cadenas-de-caracteres.html#ejercicios-37"><i class="fa fa-check"></i><b>12.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="factores.html"><a href="factores.html"><i class="fa fa-check"></i><b>13</b> Factores</a><ul>
<li class="chapter" data-level="13.1" data-path="factores.html"><a href="factores.html#encuesta-social-general"><i class="fa fa-check"></i><b>13.1</b> Encuesta social general</a><ul>
<li class="chapter" data-level="13.1.1" data-path="factores.html"><a href="factores.html#ejercicios-38"><i class="fa fa-check"></i><b>13.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="factores.html"><a href="factores.html#modificar-el-orden-de-los-factores"><i class="fa fa-check"></i><b>13.2</b> Modificar el orden de los factores</a><ul>
<li class="chapter" data-level="13.2.1" data-path="factores.html"><a href="factores.html#ejercicios-39"><i class="fa fa-check"></i><b>13.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="factores.html"><a href="factores.html#modificar-los-niveles-de-los-factores"><i class="fa fa-check"></i><b>13.3</b> Modificar los niveles de los factores</a><ul>
<li class="chapter" data-level="13.3.1" data-path="factores.html"><a href="factores.html#ejercicios-40"><i class="fa fa-check"></i><b>13.3.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html"><i class="fa fa-check"></i><b>14</b> Horas y fechas</a><ul>
<li class="chapter" data-level="14.1" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html#creando-horasfechas"><i class="fa fa-check"></i><b>14.1</b> Creando horas/fechas</a><ul>
<li class="chapter" data-level="14.1.1" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html#ejercicios-41"><i class="fa fa-check"></i><b>14.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html#componentes-fecha-hora"><i class="fa fa-check"></i><b>14.2</b> Componentes fecha-hora</a><ul>
<li class="chapter" data-level="14.2.1" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html#ejercicios-42"><i class="fa fa-check"></i><b>14.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html#plazos-de-tiempo"><i class="fa fa-check"></i><b>14.3</b> Plazos de tiempo</a><ul>
<li class="chapter" data-level="14.3.1" data-path="horas-y-fechas.html"><a href="horas-y-fechas.html#ejercicios-43"><i class="fa fa-check"></i><b>14.3.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="funciones.html"><a href="funciones.html"><i class="fa fa-check"></i><b>15</b> Funciones</a><ul>
<li class="chapter" data-level="15.1" data-path="funciones.html"><a href="funciones.html#cuando-deberias-escribir-una-funcion"><i class="fa fa-check"></i><b>15.1</b> ¿Cuándo deberías escribir una función?</a><ul>
<li class="chapter" data-level="15.1.1" data-path="funciones.html"><a href="funciones.html#practica-2"><i class="fa fa-check"></i><b>15.1.1</b> Práctica</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="funciones.html"><a href="funciones.html#las-funciones-son-para-los-humanos-y-las-computadoras"><i class="fa fa-check"></i><b>15.2</b> Las funciones son para los humanos y las computadoras</a><ul>
<li class="chapter" data-level="15.2.1" data-path="funciones.html"><a href="funciones.html#ejercicios-44"><i class="fa fa-check"></i><b>15.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="funciones.html"><a href="funciones.html#ejecucion-condicional"><i class="fa fa-check"></i><b>15.3</b> Ejecución condicional</a><ul>
<li class="chapter" data-level="15.3.1" data-path="funciones.html"><a href="funciones.html#ejercicios-45"><i class="fa fa-check"></i><b>15.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="funciones.html"><a href="funciones.html#function-arguments"><i class="fa fa-check"></i><b>15.4</b> Function arguments</a><ul>
<li class="chapter" data-level="15.4.1" data-path="funciones.html"><a href="funciones.html#ejercicios-46"><i class="fa fa-check"></i><b>15.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>16</b> Vectores</a><ul>
<li class="chapter" data-level="16.1" data-path="vectores.html"><a href="vectores.html#tipos-importantes-de-vectores-atomicos"><i class="fa fa-check"></i><b>16.1</b> Tipos importantes de vectores atómicos</a></li>
<li class="chapter" data-level="16.2" data-path="vectores.html"><a href="vectores.html#usando-vectores-atomicos"><i class="fa fa-check"></i><b>16.2</b> Usando vectores atómicos</a><ul>
<li class="chapter" data-level="16.2.1" data-path="vectores.html"><a href="vectores.html#ejercicios-47"><i class="fa fa-check"></i><b>16.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="vectores.html"><a href="vectores.html#vectores-recursivos-listas"><i class="fa fa-check"></i><b>16.3</b> Vectores Recursivos (listas)</a><ul>
<li class="chapter" data-level="16.3.1" data-path="vectores.html"><a href="vectores.html#ejercicios-48"><i class="fa fa-check"></i><b>16.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="vectores.html"><a href="vectores.html#vectores-aumentados"><i class="fa fa-check"></i><b>16.4</b> Vectores Aumentados</a><ul>
<li class="chapter" data-level="16.4.1" data-path="vectores.html"><a href="vectores.html#ejecicios"><i class="fa fa-check"></i><b>16.4.1</b> Ejecicios:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="iteracion.html"><a href="iteracion.html"><i class="fa fa-check"></i><b>17</b> Iteración</a><ul>
<li class="chapter" data-level="17.1" data-path="iteracion.html"><a href="iteracion.html#bucles-for"><i class="fa fa-check"></i><b>17.1</b> Bucles <em>for</em></a><ul>
<li class="chapter" data-level="17.1.1" data-path="iteracion.html"><a href="iteracion.html#ejercicios-49"><i class="fa fa-check"></i><b>17.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="iteracion.html"><a href="iteracion.html#variaciones-de-bucles-for"><i class="fa fa-check"></i><b>17.2</b> Variaciones de bucles <em>for</em></a><ul>
<li class="chapter" data-level="17.2.1" data-path="iteracion.html"><a href="iteracion.html#ejercicios-50"><i class="fa fa-check"></i><b>17.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="iteracion.html"><a href="iteracion.html#bucles-for-vs.funcionales"><i class="fa fa-check"></i><b>17.3</b> Bucles <em>for</em> vs. funcionales</a><ul>
<li class="chapter" data-level="17.3.1" data-path="iteracion.html"><a href="iteracion.html#ejercicios-51"><i class="fa fa-check"></i><b>17.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="iteracion.html"><a href="iteracion.html#las-funciones-map-mapa-en-ingles"><i class="fa fa-check"></i><b>17.4</b> Las funciones <em>map</em> (mapa en inglés)</a><ul>
<li class="chapter" data-level="17.4.1" data-path="iteracion.html"><a href="iteracion.html#ejercicios-52"><i class="fa fa-check"></i><b>17.4.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="iteracion.html"><a href="iteracion.html#otros-patrones-para-los-loops-for"><i class="fa fa-check"></i><b>17.5</b> Otros patrones para los loops for</a><ul>
<li class="chapter" data-level="17.5.1" data-path="iteracion.html"><a href="iteracion.html#ejercicios-53"><i class="fa fa-check"></i><b>17.5.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Modelar</b></span></li>
<li class="chapter" data-level="18" data-path="model-intro.html"><a href="model-intro.html"><i class="fa fa-check"></i><b>18</b> Introducción</a></li>
<li class="chapter" data-level="19" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html"><i class="fa fa-check"></i><b>19</b> Modelos: conceptos básicos</a><ul>
<li class="chapter" data-level="19.1" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#paquetes-necesarios-2"><i class="fa fa-check"></i><b>19.1</b> Paquetes necesarios</a></li>
<li class="chapter" data-level="19.2" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#un-modelo-simple"><i class="fa fa-check"></i><b>19.2</b> Un modelo simple</a><ul>
<li class="chapter" data-level="19.2.1" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#ejercicios-54"><i class="fa fa-check"></i><b>19.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#visualizando-modelos"><i class="fa fa-check"></i><b>19.3</b> Visualizando modelos</a><ul>
<li class="chapter" data-level="19.3.1" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#ejercicios-55"><i class="fa fa-check"></i><b>19.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#formulas-y-familias-de-modelos"><i class="fa fa-check"></i><b>19.4</b> Fórmulas y familias de modelos</a><ul>
<li class="chapter" data-level="19.4.1" data-path="modelos-conceptos-basicos.html"><a href="modelos-conceptos-basicos.html#ejercicios-56"><i class="fa fa-check"></i><b>19.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>20</b> Model building</a></li>
<li class="chapter" data-level="21" data-path="muchos-modelos.html"><a href="muchos-modelos.html"><i class="fa fa-check"></i><b>21</b> Muchos modelos</a><ul>
<li class="chapter" data-level="21.1" data-path="muchos-modelos.html"><a href="muchos-modelos.html#paquetes-necesarios-3"><i class="fa fa-check"></i><b>21.1</b> Paquetes necesarios</a></li>
<li class="chapter" data-level="21.2" data-path="muchos-modelos.html"><a href="muchos-modelos.html#gapminder"><i class="fa fa-check"></i><b>21.2</b> gapminder</a><ul>
<li class="chapter" data-level="21.2.1" data-path="muchos-modelos.html"><a href="muchos-modelos.html#ejercicios-57"><i class="fa fa-check"></i><b>21.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="muchos-modelos.html"><a href="muchos-modelos.html#creando-columnas-lista"><i class="fa fa-check"></i><b>21.3</b> Creando columnas-lista</a><ul>
<li class="chapter" data-level="21.3.1" data-path="muchos-modelos.html"><a href="muchos-modelos.html#ejercicios-58"><i class="fa fa-check"></i><b>21.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="muchos-modelos.html"><a href="muchos-modelos.html#simplificando-columnas-lista"><i class="fa fa-check"></i><b>21.4</b> Simplificando columnas-lista</a><ul>
<li class="chapter" data-level="21.4.1" data-path="muchos-modelos.html"><a href="muchos-modelos.html#ejercicios-59"><i class="fa fa-check"></i><b>21.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>22</b> R Markdown</a><ul>
<li class="chapter" data-level="22.1" data-path="r-markdown.html"><a href="r-markdown.html#r-markdown-basico"><i class="fa fa-check"></i><b>22.1</b> R Markdown básico</a><ul>
<li class="chapter" data-level="22.1.1" data-path="r-markdown.html"><a href="r-markdown.html#ejercicios-60"><i class="fa fa-check"></i><b>22.1.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="r-markdown.html"><a href="r-markdown.html#formateo-de-texto-con-markdown"><i class="fa fa-check"></i><b>22.2</b> Formateo de texto con Markdown</a><ul>
<li class="chapter" data-level="22.2.1" data-path="r-markdown.html"><a href="r-markdown.html#ejercicios-61"><i class="fa fa-check"></i><b>22.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="r-markdown.html"><a href="r-markdown.html#bloques-de-codigo"><i class="fa fa-check"></i><b>22.3</b> Bloques de código</a><ul>
<li class="chapter" data-level="22.3.1" data-path="r-markdown.html"><a href="r-markdown.html#ejercicios-62"><i class="fa fa-check"></i><b>22.3.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html"><i class="fa fa-check"></i><b>23</b> Comunicar con gráficos</a><ul>
<li class="chapter" data-level="23.1" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#paquetes-necesarios-4"><i class="fa fa-check"></i><b>23.1</b> Paquetes necesarios</a></li>
<li class="chapter" data-level="23.2" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#etiquetas"><i class="fa fa-check"></i><b>23.2</b> Etiquetas</a><ul>
<li class="chapter" data-level="23.2.1" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#ejercicios-63"><i class="fa fa-check"></i><b>23.2.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#anotaciones"><i class="fa fa-check"></i><b>23.3</b> Anotaciones</a><ul>
<li class="chapter" data-level="23.3.1" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#ejercicios-64"><i class="fa fa-check"></i><b>23.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#escalas"><i class="fa fa-check"></i><b>23.4</b> Escalas</a><ul>
<li class="chapter" data-level="23.4.1" data-path="comunicar-con-graficos.html"><a href="comunicar-con-graficos.html#ejercicios-65"><i class="fa fa-check"></i><b>23.4.1</b> Ejercicios</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="r-markdown-formats.html"><a href="r-markdown-formats.html"><i class="fa fa-check"></i><b>24</b> R Markdown formats</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R para Ciencia de Datos: Soluciones de los ejercicios</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datos-relacionales" class="section level1">
<h1><span class="header-section-number">11</span> Datos relacionales</h1>
<div id="paquetes-necesarios-1" class="section level2">
<h2><span class="header-section-number">11.1</span> Paquetes necesarios</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(datos)</a></code></pre></div>
</div>
<div id="nycflights13-relational" class="section level2">
<h2><span class="header-section-number">11.2</span> datos</h2>
<div id="ejercicios-21" class="section level3">
<h3><span class="header-section-number">11.2.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li>Imagina que necesitas dibujar (aproximadamente) la ruta que cada avión vuela
desde su origen hasta el destino. ¿Qué variables necesitas? ¿Qué tablas
necesitas combinar?</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Necesitas combinar <code>aeropuertos</code> con <code>vuelos</code> ya que el dataset <code>aeropuertos</code>
con tiene las coordenadas de los aeropuertos. Puedes unir las tablas por medio
de la variable <code>codigo_aeropuerto</code> en <code>aeropuertos</code> y <code>origen</code> y <code>destino</code> en
<code>vuelos</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(aeropuertos, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origen&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">                                <span class="st">&quot;destino&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 26
##     anio   mes   dia horario_salida salida_programa… atraso_salida
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;          &lt;int&gt;            &lt;int&gt;         &lt;dbl&gt;
##  1  2013     1     1            517              515             2
##  2  2013     1     1            533              529             4
##  3  2013     1     1            542              540             2
##  4  2013     1     1            544              545            -1
##  5  2013     1     1            554              600            -6
##  6  2013     1     1            554              558            -4
##  7  2013     1     1            555              600            -5
##  8  2013     1     1            557              600            -3
##  9  2013     1     1            557              600            -3
## 10  2013     1     1            558              600            -2
## # … with 336,766 more rows, and 20 more variables: horario_llegada &lt;int&gt;,
## #   llegada_programada &lt;int&gt;, atraso_llegada &lt;dbl&gt;, aerolinea &lt;chr&gt;,
## #   vuelo &lt;int&gt;, codigo_cola &lt;chr&gt;, origen &lt;chr&gt;, destino &lt;chr&gt;,
## #   tiempo_vuelo &lt;dbl&gt;, distancia &lt;dbl&gt;, hora &lt;dbl&gt;, minuto &lt;dbl&gt;,
## #   fecha_hora &lt;dttm&gt;, nombre &lt;chr&gt;, latitud &lt;dbl&gt;, longitud &lt;dbl&gt;,
## #   altura &lt;int&gt;, zona_horaria &lt;dbl&gt;, horario_verano &lt;chr&gt;,
## #   zona_horaria_iana &lt;chr&gt;</code></pre>
</div>
<ol style="list-style-type: decimal">
<li>Olvidamos incluir la relación entre <code>clima</code> y <code>aeropuertos</code>. ¿Cuál es la
relación y cómo debe aparecer en el diagrama?</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>De manera similar al ejercicio anterior, se pueden unir mediante
<code>codigo_aeropuerto</code> en <code>aeropuertos</code> y <code>origen</code> en <code>clima</code>.</p>
</div>
<ol style="list-style-type: decimal">
<li><code>clima</code> únicamente contiene información de los aeropuertos de origen
(Nueva York). Si contuviera registros para todos los aeropuertos de EEUU, ¿Qué
relación tendría con <code>vuelos</code>?</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Puedes conectar <code>clima</code> con <code>vuelos</code> usando la columna <code>destino</code> e incluir el
clima de los aeropuertos de EEUU que están presentes en la tabla <code>vuelos</code>.</p>
</div>
<ol style="list-style-type: decimal">
<li>Sabemos que hay días “especiales” en el año y pocas personas vuelan esos
días. ¿Cómo se representarían en un data frame? ¿Cuáles serían las llaves
primarias de esa tabla? ¿Cómo se conectaría con las tablas existentes?</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Una posibilidad es contar con un dataset de los días festivos en EEUU indicando
mes y día. Esta información se puede unir con cada vuelo en la tabla <code>vuelos</code> y
y a la vez con el dataset <code>clima</code>.</p>
</div>
</div>
</div>
<div id="llaves" class="section level2">
<h2><span class="header-section-number">11.3</span> Llaves</h2>
<div id="ejercicios-22" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li>Agrega una llave sustituta a <code>vuelos</code>.</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">row_number</span>(anio)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(id, <span class="kw">everything</span>())</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 20
##       id  anio   mes   dia horario_salida salida_programa… atraso_salida
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;          &lt;int&gt;            &lt;int&gt;         &lt;dbl&gt;
##  1     1  2013     1     1            517              515             2
##  2     2  2013     1     1            533              529             4
##  3     3  2013     1     1            542              540             2
##  4     4  2013     1     1            544              545            -1
##  5     5  2013     1     1            554              600            -6
##  6     6  2013     1     1            554              558            -4
##  7     7  2013     1     1            555              600            -5
##  8     8  2013     1     1            557              600            -3
##  9     9  2013     1     1            557              600            -3
## 10    10  2013     1     1            558              600            -2
## # … with 336,766 more rows, and 13 more variables: horario_llegada &lt;int&gt;,
## #   llegada_programada &lt;int&gt;, atraso_llegada &lt;dbl&gt;, aerolinea &lt;chr&gt;,
## #   vuelo &lt;int&gt;, codigo_cola &lt;chr&gt;, origen &lt;chr&gt;, destino &lt;chr&gt;,
## #   tiempo_vuelo &lt;dbl&gt;, distancia &lt;dbl&gt;, hora &lt;dbl&gt;, minuto &lt;dbl&gt;,
## #   fecha_hora &lt;dttm&gt;</code></pre>
</div>
<ol style="list-style-type: decimal">
<li><p>Identifica las llaves en los siguientes conjuntos de datos</p></li>
<li><code>datos::bateadores</code></li>
<li><code>datos::nombres</code></li>
<li><code>datos::atmosfera</code></li>
<li><code>datos::vehiculos</code></li>
<li><p><code>datos::diamantes</code></p></li>
</ol>
<p>(Puede que necesites leer un poco de documentación.)</p>
<div class="solucion">
<h3>
Solución
</h3>
<ol style="list-style-type: decimal">
<li>En <code>datos::bateadores</code> corresponde a <code>id_jugador</code>.</li>
<li>En <code>datos::nombres</code> corresponde a la combinación de <code>anio</code> y <code>nombre</code>,
con esto se puede unir cada par año-nombre con las otras tablas.</li>
<li>En <code>datos::atmosfera</code> corresponde a latitud<code>,</code>longitud<code>,</code>anio<code>y</code>mes`,
lo cual identifica de manera única un lugar en el tiempo.</li>
<li>En <code>datos::vehiculos</code> corresponde a <code>id</code>.</li>
<li>En <code>datos::diamantes</code> no hay llaves ya que estas tienen sentido en datos
relacionales, es decir cuando existen otras tablas para combinar información.</li>
</ol>
</div>
<ol style="list-style-type: decimal">
<li>Dibuja un diagrama que ilustre las conexiones entre las tablas <code>bateadores</code>,
<code>personas</code> y <code>salarios</code> en el paquete datos. Dibuja otro diagrama que muestre la
relación entre <code>personas</code>, <code>dirigentes</code> y <code>premios_dirigentes</code>.</li>
</ol>
<p>¿Cómo caracterizarías las relación entre <code>bateadores</code>, <code>lanzadores</code> y <code>fildeo</code>?</p>
<div class="solucion">
<h3>
Solución
</h3>
<p>Es directo. Las tres tablas contienen los campos <code>id_jugador</code> y <code>anio</code> y cada
tabla contiene información que complementa las demás. La relación es uno a uno.</p>
</div>
</div>
</div>
<div id="mutating-joins" class="section level2">
<h2><span class="header-section-number">11.4</span> Uniones de transformación</h2>
<div id="ejercicios-23" class="section level3">
<h3><span class="header-section-number">11.4.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li>Calcula el atraso promedio por destino, luego une los datos en <code>aeropuertos</code>
para que puedas mostrar la distribución espacial de los atrasos. Te presentamos
una forma fácil de dibujar un mapa de los Estados Unidos:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">aeropuertos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st"> </span><span class="kw">semi_join</span>(vuelos, <span class="kw">c</span>(<span class="st">&quot;codigo_aeropuerto&quot;</span> =<span class="st"> &quot;destino&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(longitud, latitud)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st"> </span><span class="kw">borders</span>(<span class="st">&quot;state&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st"> </span><span class="kw">coord_quickmap</span>()</a></code></pre></div>
<p>(No te preocupes si no entiendes que hace <code>semi_join()</code>.
Lo aprenderás a continuación.)</p>
<p>Quizás quieras usar <code>size</code> o <code>colour</code> para editar los puntos y mostrar
el atraso promedio de cada aeropuerto.</p>
<div class="solucion">
<h3>
Solución
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">atraso_promedio_destino &lt;-<span class="st"> </span>vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">   </span><span class="kw">group_by</span>(destino) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">   </span><span class="co"># los vuelos con NA en atraso_llegada son vuelos cancelados</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">   </span><span class="kw">summarise</span>(<span class="dt">atraso =</span> <span class="kw">mean</span>(atraso_llegada, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">   </span><span class="kw">inner_join</span>(aeropuertos, <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">destino =</span> <span class="st">&quot;codigo_aeropuerto&quot;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">atraso_promedio_destino <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(longitud, latitud, <span class="dt">colour =</span> atraso)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">borders</span>(<span class="st">&quot;state&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_quickmap</span>()</a></code></pre></div>
<p><img src="13-relational-data_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<ol style="list-style-type: decimal">
<li>Agrega la ubicación de origen <em>y</em> destino (e.g. <code>latitud</code> y <code>longitud</code>)
a <code>vuelos</code>.</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Es posible realizar varias uniones. Si hay variables duplicadas, dplyr va a
distinguirlas agregando <code>.x</code> y <code>.y</code> al nombre de la variable para resolver
los nombres duplicados.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">ubicacion_aeropuertos &lt;-<span class="st"> </span>aeropuertos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(codigo_aeropuerto, latitud, longitud)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(anio<span class="op">:</span>dia, hora, origen, destino) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    ubicacion_aeropuertos,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origen&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">    ubicacion_aeropuertos,</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;destino&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>)</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">  )</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 10
##     anio   mes   dia  hora origen destino latitud.x longitud.x latitud.y
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  2013     1     1     5 EWR    IAH          40.7      -74.2      30.0
##  2  2013     1     1     5 LGA    IAH          40.8      -73.9      30.0
##  3  2013     1     1     5 JFK    MIA          40.6      -73.8      25.8
##  4  2013     1     1     5 JFK    BQN          40.6      -73.8      NA  
##  5  2013     1     1     6 LGA    ATL          40.8      -73.9      33.6
##  6  2013     1     1     5 EWR    ORD          40.7      -74.2      42.0
##  7  2013     1     1     6 EWR    FLL          40.7      -74.2      26.1
##  8  2013     1     1     6 LGA    IAD          40.8      -73.9      38.9
##  9  2013     1     1     6 JFK    MCO          40.6      -73.8      28.4
## 10  2013     1     1     6 LGA    ORD          40.8      -73.9      42.0
## # … with 336,766 more rows, and 1 more variable: longitud.y &lt;dbl&gt;</code></pre>
<p>Es una buena práctica tener nombres indicativos para las variables. Usaremos
el sufijo <code>_destino</code> y <code>_origen</code> para especificar a qué aeropuerto nos referimos.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(anio<span class="op">:</span>dia, hora, origen, destino) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">    ubicacion_aeropuertos,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;origen&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    ubicacion_aeropuertos,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">    <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;destino&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>),</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">    <span class="dt">suffix =</span> <span class="kw">c</span>(<span class="st">&quot;_origen&quot;</span>, <span class="st">&quot;_destino&quot;</span>)</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">  )</a></code></pre></div>
<pre><code>## # A tibble: 336,776 x 10
##     anio   mes   dia  hora origen destino latitud_origen longitud_origen
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;            &lt;dbl&gt;           &lt;dbl&gt;
##  1  2013     1     1     5 EWR    IAH               40.7           -74.2
##  2  2013     1     1     5 LGA    IAH               40.8           -73.9
##  3  2013     1     1     5 JFK    MIA               40.6           -73.8
##  4  2013     1     1     5 JFK    BQN               40.6           -73.8
##  5  2013     1     1     6 LGA    ATL               40.8           -73.9
##  6  2013     1     1     5 EWR    ORD               40.7           -74.2
##  7  2013     1     1     6 EWR    FLL               40.7           -74.2
##  8  2013     1     1     6 LGA    IAD               40.8           -73.9
##  9  2013     1     1     6 JFK    MCO               40.6           -73.8
## 10  2013     1     1     6 LGA    ORD               40.8           -73.9
## # … with 336,766 more rows, and 2 more variables: latitud_destino &lt;dbl&gt;,
## #   longitud_destino &lt;dbl&gt;</code></pre>
</div>
<ol style="list-style-type: decimal">
<li>¿Existe una relación entre la antiguedad de un avión y sus atrasos?</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Ya que no se indica si se refiere a atrasos de salida o llegada, se explorará
el atraso en la salida, quedando el otro caso como ejercicio.</p>
<p>Para comparar la antiguedad de un avión con sus atrasos, hay que unir
<code>vuelos</code> con <code>aviones</code>, esta última tabla contiene la variable <code>anio</code> que se
refiere al año de fabricación del avión.</p>
<p>Dado que hay pocos aviones de más de 25 años, truncaremos los datos y luego
vamos a calcular el promedio de llegada y salida dada la antiguedad.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">atrasos_por_antiguedad &lt;-<span class="st"> </span><span class="kw">inner_join</span>(vuelos,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">   <span class="kw">select</span>(aviones, codigo_cola, <span class="dt">anio_fabricacion =</span> anio), <span class="dt">by =</span> <span class="st">&quot;codigo_cola&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">antiguedad =</span> anio <span class="op">-</span><span class="st"> </span>anio_fabricacion) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">   </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(antiguedad)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">antiguedad =</span> <span class="kw">if_else</span>(antiguedad <span class="op">&gt;</span><span class="st"> </span><span class="dv">25</span>, 25L, antiguedad)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">   </span><span class="kw">group_by</span>(antiguedad) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">   </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">      <span class="dt">prom_atraso_salida =</span> <span class="kw">mean</span>(atraso_salida, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">      <span class="dt">desv_est_atraso_salida =</span> <span class="kw">sd</span>(atraso_salida, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">      <span class="dt">nro_vuelos_atrasados_salida =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(atraso_salida))</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">   )</a></code></pre></div>
<p>Ahora podemos explorar la reglación entre los atrasos en la salida y la
antiguedad.</p>
<p>El atraso en la salida es creciente en relación a la antiguedad para los
aviones de hasta de 10 años. Luego este atraso decae.</p>
<p>La reducción de los atrasos en la salida en relación a la antiguedad puede
deberse a que en los aviones más antiguos se planfica la mantención para evitar
tales atrasos y desperfectos mecánicos.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">ggplot</span>(atrasos_por_antiguedad, <span class="kw">aes</span>(<span class="dt">x =</span> antiguedad, <span class="dt">y =</span> prom_atraso_salida)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Antiguedad del avión (años)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Atraso promedio en la salida (minutos)&quot;</span>)</a></code></pre></div>
<p><img src="13-relational-data_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<ol style="list-style-type: decimal">
<li>¿Qué condiciones climáticas hacen más probables los atrasos?</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Las lluvias están asociadas con los atrasos. Sin embargo, para un nivel
mayor a 0.02 pulgadas de lluvia no hay una tendencia fuerte.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">vuelo_clima &lt;-<span class="st"> </span>vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="st">  </span><span class="kw">inner_join</span>(clima, <span class="dt">by =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">    <span class="st">&quot;origen&quot;</span>,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">    <span class="st">&quot;anio&quot;</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">    <span class="st">&quot;mes&quot;</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">    <span class="st">&quot;dia&quot;</span>,</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">    <span class="st">&quot;hora&quot;</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">  ))</a>
<a class="sourceLine" id="cb15-9" data-line-number="9"></a>
<a class="sourceLine" id="cb15-10" data-line-number="10">vuelo_clima <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="st">  </span><span class="kw">group_by</span>(precipitacion) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">atraso =</span> <span class="kw">mean</span>(atraso_salida, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> precipitacion, <span class="dt">y =</span> atraso)) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="13-relational-data_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<ol style="list-style-type: decimal">
<li>¿Qué sucedió el día 13 de junio de 2013? Muestra el patrón espacial de los atrasos,
luego usa un buscador para encontrar referencias cruzadas con el clima.</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Hubo una serie de tormentas en el sureste de los EEUU (consulta la <a href="https://en.wikipedia.org/wiki/June_12%E2%80%9313,_2013_derecho_series">Wikipedia</a>).</p>
<p>El siguiente gráfico muestra que los mayores atrasos se presentaron en
Tennessee (Nashville), el sureste y medio oeste es donde ocurrieron las
tormentas.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(anio <span class="op">==</span><span class="st"> </span><span class="dv">2013</span>, mes <span class="op">==</span><span class="st"> </span><span class="dv">6</span>, dia <span class="op">==</span><span class="st"> </span><span class="dv">13</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(destino) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">atraso =</span> <span class="kw">mean</span>(atraso_salida, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="st">  </span><span class="kw">inner_join</span>(aeropuertos, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;destino&quot;</span> =<span class="st"> &quot;codigo_aeropuerto&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> latitud, <span class="dt">x =</span> longitud, <span class="dt">size =</span> atraso, <span class="dt">colour =</span> atraso)) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="st">  </span><span class="kw">borders</span>(<span class="st">&quot;state&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_quickmap</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_colour_viridis_c</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
<p><img src="13-relational-data_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="filtering-joins" class="section level2">
<h2><span class="header-section-number">11.5</span> Uniones de filtro</h2>
<div id="ejercicios-24" class="section level3">
<h3><span class="header-section-number">11.5.1</span> Ejercicios</h3>
<ol style="list-style-type: decimal">
<li>¿Qué significa que un vuelo no tenga <code>codigo_cola</code>? ¿Qué tienen en común los códigos
de cola que no tienen registros coincidentes en <code>aviones</code>? (Pista: Una variable explica
~90% de los problemas.)</li>
</ol>
<div class="solucion">
<h3>
Solución
</h3>
<p>Los vuelos que no registran código cola tampoco registran hora de llegada, por
lo que son vuelos cancelados.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">is.na</span>(codigo_cola), <span class="op">!</span><span class="kw">is.na</span>(horario_llegada)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="st">  </span><span class="kw">nrow</span>()</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Muchos de los vuelos sin código cola en <code>aviones</code> pertenecen a
American Airlines (AA) o Envoy Airlines (EQ) como se detalla en la documentación.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw">anti_join</span>(aviones, <span class="dt">by =</span> <span class="st">&quot;codigo_cola&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">count</span>(aerolinea, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n))</a></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    aerolinea     n        p
##    &lt;chr&gt;     &lt;int&gt;    &lt;dbl&gt;
##  1 MQ        25397 0.483   
##  2 AA        22558 0.429   
##  3 UA         1693 0.0322  
##  4 9E         1044 0.0198  
##  5 B6          830 0.0158  
##  6 US          699 0.0133  
##  7 FL          187 0.00355 
##  8 DL          110 0.00209 
##  9 F9           50 0.000950
## 10 WN           38 0.000722</code></pre>
<p>Sin embargo, no todos los códigos que aparecen en <code>vuelos</code> están perdidos en
<code>aviones</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">vuelos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="st">  </span><span class="kw">distinct</span>(aerolinea, codigo_cola) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="st">  </span><span class="kw">left_join</span>(aviones, <span class="dt">by =</span> <span class="st">&quot;codigo_cola&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(aerolinea) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total_aviones =</span> <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">            <span class="dt">faltan_en_aviones =</span> <span class="kw">sum</span>(<span class="kw">is.na</span>(modelo))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">porcentaje_perdidos =</span> faltan_en_aviones <span class="op">/</span><span class="st"> </span>total_aviones) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(porcentaje_perdidos))</a></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##    aerolinea total_aviones faltan_en_aviones porcentaje_perdidos
##    &lt;chr&gt;             &lt;int&gt;             &lt;int&gt;               &lt;dbl&gt;
##  1 MQ                  238               234             0.983  
##  2 AA                  601               430             0.715  
##  3 F9                   26                 3             0.115  
##  4 FL                  129                12             0.0930 
##  5 UA                  621                23             0.0370 
##  6 US                  290                 9             0.0310 
##  7 DL                  629                10             0.0159 
##  8 B6                  193                 3             0.0155 
##  9 WN                  583                 3             0.00515
## 10 9E                  204                 1             0.00490
## 11 AS                   84                 0             0      
## 12 EV                  316                 0             0      
## 13 HA                   14                 0             0      
## 14 OO                   28                 0             0      
## 15 VX                   53                 0             0      
## 16 YV                   58                 0             0</code></pre>
</div>
<ol style="list-style-type: decimal">
<li><p>Filtra los vuelos para mostrar únicamente los aviones que han realizado al menos cien
viajes.</p></li>
<li><p>Combina <code>vehiculos</code> y <code>comunes</code> para encontrar los registros de los
modelos más comunes.</p></li>
<li><p>Encuentra las 48 horas (en el transcurso del año) que tengan los peores atrasos. Haz
una referencia cruzada con la tabla <code>clima</code>. ¿Puedes observar patrones?</p></li>
<li><p>¿Qué te indica <code>anti_join(vuelos, aeropuertos, by = c(&quot;destino&quot; = &quot;codigo_aeropuerto&quot;))</code>?
¿Qué te indica <code>anti_join(aeropuertos, vuelos, by = c(&quot;codigo_aeropuerto&quot; = &quot;destino&quot;))</code>?</p></li>
<li><p>Puedes esperar que exista una relación implícita entre aviones y aerolíneas, dado que cada
avión es operado por una única aerolínea. Confirma o descarta esta hipótesis usando las
herramientas que aprendiste más arriba.</p></li>
</ol>
</div>
</div>
<div id="problemas-de-las-uniones" class="section level2">
<h2><span class="header-section-number">11.6</span> Problemas de las uniones</h2>
<p>Los datos con los que has estado trabajando en este capítulo han sido limpiados de modo que tengas el mínimo de problemas posibles. Tus propios datos difícilmente estarán tan ordenados, por lo que hay algunas consideraciones y pasos a tener en cuenta para que las uniones sobre tus propios datos funcionen adecuadamente.</p>
<ol style="list-style-type: decimal">
<li><p>Comienza identificando las variables que forman las llaves primarias en cada tabla.
Usualmente debieras hacerlo basado en tus conocimientos de los datos, no observando
empíricamente las combinaciones de variables que resultan en un identificador único.
Si te centras en las variables sin pensar en sus significados, puedes tener la mala
suerte de encontrar una combinación única en tus datos pero dicha relación puede no ser válida en general.</p>
<p>Por ejemplo, la altura y la longitud identifican de manera única cada aeropuerto, ¡pero
no son buenos identificadores!</p></li>
</ol>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">aeropuertos <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(altura, longitud) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 0 x 3
## # … with 3 variables: altura &lt;int&gt;, longitud &lt;dbl&gt;, n &lt;int&gt;</code></pre>
<ol style="list-style-type: decimal">
<li><p>Verifica que ninguna de las variables en la llave primaria esté perdida.
¡Si un valor está perdido no puede identificar una observación!</p></li>
<li><p>Verifica que las llaves foráneas coinciden con las llaves primarias en
otra tabla. La mejor forma de hacerlo es mediante <code>anti_join()</code>. Es común
que las llaves no coincidan debido a errores en la entrada de datos. Arreglar
este problema requiere mucho trabajo.</p>
<p>Si tienes llaves perdidas, debes ser cuidadoso respecto del uso de unión interior
versus unión exterior y considerar cuidadosamente si quieres descartar las observaciones
que no tienen coincidencias.</p>
<p>Ten en cuenta que verificiar el número de filas antes y después de unir no es suficiente para asegurar
que la unión funcionó de forma exitosa. Si tienes una unión interior con llaves duplicadas en ambas tablas,
puedes tener la mala suerte de que el número de filas descartadas sea igual al número de filas duplicadas.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datos-ordenados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cadenas-de-caracteres.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/cienciadedatos/r4ds-soluciones/edit/master/13-relational-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
